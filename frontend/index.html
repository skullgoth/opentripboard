<!DOCTYPE html>
<!-- T041: Frontend entry point with semantic HTML -->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="OpenTripBoard - Comprehensive travel planning suite with collaborative features">
  <meta name="theme-color" content="#3B82F6">

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico">

  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="TripBoard">

  <!-- Security -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <!-- Note: X-Frame-Options must be set via HTTP headers (nginx/backend), not meta tags -->

  <title>OpenTripBoard - Plan Your Perfect Trip</title>

  <!-- Preconnect to API -->
  <link rel="preconnect" href="/api">

  <!-- Styles -->
  <link rel="stylesheet" href="/src/styles/variables.css">
  <link rel="stylesheet" href="/src/styles/base.css">
  <link rel="stylesheet" href="/src/styles/components.css">
  <link rel="stylesheet" href="/src/styles/components/icon-picker.css">
  <link rel="stylesheet" href="/src/styles/components/category-manager.css">
  <link rel="stylesheet" href="/src/styles/components/category-select.css">

  <!-- Preconnect to OpenStreetMap tile server for faster map rendering -->
  <link rel="preconnect" href="https://a.tile.openstreetmap.org" crossorigin>
  <link rel="preconnect" href="https://b.tile.openstreetmap.org" crossorigin>
  <link rel="preconnect" href="https://c.tile.openstreetmap.org" crossorigin>

  <!-- Theme initialization (inline to prevent flash) -->
  <script>
    (function() {
      function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) {
          return parts.pop().split(';').shift();
        }
        return null;
      }

      function getOSThemePreference() {
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          return 'dark';
        }
        return 'light';
      }

      // Get theme from cookie or OS preference
      const cookieTheme = getCookie('theme-preference');
      const theme = (cookieTheme === 'light' || cookieTheme === 'dark')
        ? cookieTheme
        : getOSThemePreference();

      // Apply theme immediately (always set attribute for explicit control)
      document.documentElement.setAttribute('data-theme', theme);
    })();
  </script>
</head>
<body>
  <!-- Skip to main content for accessibility -->
  <a href="#main-content" class="skip-link">Skip to main content</a>

  <!-- Application root -->
  <div id="app">
    <!-- Header -->
    <header id="app-header" class="header">
      <div class="container">
        <div class="header-content">
          <h1 class="logo">
            <a href="/" data-link aria-label="OpenTripBoard Home">OpenTripBoard</a>
          </h1>

          <nav id="main-nav" class="nav" aria-label="Main navigation">
            <!-- Navigation will be populated by JavaScript -->
          </nav>

          <div id="user-menu" class="user-menu">
            <!-- User menu will be populated by JavaScript -->
          </div>
        </div>
      </div>
    </header>

    <!-- Main content -->
    <main id="main-content" class="main-content">
      <div class="container">
        <!-- Page content will be dynamically rendered here -->
        <div id="page-container"></div>
      </div>
    </main>

  </div>

  <!-- Loading overlay -->
  <div id="loading-overlay" class="loading-overlay hidden" aria-live="polite" aria-busy="true">
    <div class="spinner" role="status">
      <span class="sr-only">Loading...</span>
    </div>
  </div>

  <!-- Toast notifications container -->
  <div id="toast-container" class="toast-container" aria-live="polite" aria-atomic="true"></div>

  <!-- Modal container -->
  <div id="modal-container" class="modal-container"></div>

  <!-- Application entry point -->
  <script type="module" src="/src/main.js"></script>
</body>
</html>
